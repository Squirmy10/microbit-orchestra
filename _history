{"entries":[{"timestamp":1771899664729,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":18293,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":795,"diffs":[[1,""]]},{"start1":1,"length1":11806,"diffs":[[1,""]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":233,"length1":35,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]}]},{"timestamp":1771900245476,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":157,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><comment x=\"1082.25\" y=\"20\" w=\"480\" h=\"360\">\n═══════════════════════════════════════════════════════════════\nREADY TO USE!\n═══════════════════════════════════════════════════════════════\n\nThe Orchestra blocks are now available in your toolbox!\nLook for the orange \"Orchestra\" category.\n\nQuick Start Example - Try this code:\n\norchestra.setTempo(120)\norchestra.playNote(orchestra.Note.C4, orchestra.Duration.Quarter)\norchestra.playNote(orchestra.Note.E4, orchestra.Duration.Quarter)\norchestra.playNote(orchestra.Note.G4, orchestra.Duration.Quarter)\norchestra.playNote(orchestra.Note.C5, orchestra.Duration.Half)\n\nOr switch to Blocks view and drag Orchestra blocks!\n\n═══════════════════════════════════════════════════════════════\n</comment><block type=\"pxt-on-start\" x=\"20\" y=\"20\"><statement name=\"HANDLER\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"namespace orchestra {\" line1=\"\" line2=\"    /**\" line3=\"     * All musical notes from C2 (bass) to B6 (high treble)\" line4=\"     * Full orchestral range\" line5=\"     */\" line6=\"    export enum Note {\" line7=\"        //% block=&quot;C2&quot;\" line8=\"        C2 = 65,\" line9=\"        //% block=&quot;C#2&quot;\" line10=\"        Cs2 = 69,\" line11=\"        //% block=&quot;D2&quot;\" line12=\"        D2 = 73,\" line13=\"        //% block=&quot;D#2&quot;\" line14=\"        Ds2 = 78,\" line15=\"        //% block=&quot;E2&quot;\" line16=\"        E2 = 82,\" line17=\"        //% block=&quot;F2&quot;\" line18=\"        F2 = 87,\" line19=\"        //% block=&quot;F#2&quot;\" line20=\"        Fs2 = 93,\" line21=\"        //% block=&quot;G2&quot;\" line22=\"        G2 = 98,\" line23=\"        //% block=&quot;G#2&quot;\" line24=\"        Gs2 = 104,\" line25=\"        //% block=&quot;A2&quot;\" line26=\"        A2 = 110,\" line27=\"        //% block=&quot;A#2&quot;\" line28=\"        As2 = 117,\" line29=\"        //% block=&quot;B2&quot;\" line30=\"        B2 = 123,\" line31=\"        //% block=&quot;C3&quot;\" line32=\"        C3 = 131,\" line33=\"        //% block=&quot;C#3&quot;\" line34=\"        Cs3 = 139,\" line35=\"        //% block=&quot;D3&quot;\" line36=\"        D3 = 147,\" line37=\"        //% block=&quot;D#3&quot;\" line38=\"        Ds3 = 156,\" line39=\"        //% block=&quot;E3&quot;\" line40=\"        E3 = 165,\" line41=\"        //% block=&quot;F3&quot;\" line42=\"        F3 = 175,\" line43=\"        //% block=&quot;F#3&quot;\" line44=\"        Fs3 = 185,\" line45=\"        //% block=&quot;G3&quot;\" line46=\"        G3 = 196,\" line47=\"        //% block=&quot;G#3&quot;\" line48=\"        Gs3 = 208,\" line49=\"        //% block=&quot;A3&quot;\" line50=\"        A3 = 220,\" line51=\"        //% block=&quot;A#3&quot;\" line52=\"        As3 = 233,\" line53=\"        //% block=&quot;B3&quot;\" line54=\"        B3 = 247,\" line55=\"        //% block=&quot;C4&quot;\" line56=\"        C4 = 262,\" line57=\"        //% block=&quot;C#4&quot;\" line58=\"        Cs4 = 277,\" line59=\"        //% block=&quot;D4&quot;\" line60=\"        D4 = 294,\" line61=\"        //% block=&quot;D#4&quot;\" line62=\"        Ds4 = 311,\" line63=\"        //% block=&quot;E4&quot;\" line64=\"        E4 = 330,\" line65=\"        //% block=&quot;F4&quot;\" line66=\"        F4 = 349,\" line67=\"        //% block=&quot;F#4&quot;\" line68=\"        Fs4 = 370,\" line69=\"        //% block=&quot;G4&quot;\" line70=\"        G4 = 392,\" line71=\"        //% block=&quot;G#4&quot;\" line72=\"        Gs4 = 415,\" line73=\"        //% block=&quot;A4&quot;\" line74=\"        A4 = 440,\" line75=\"        //% block=&quot;A#4&quot;\" line76=\"        As4 = 466,\" line77=\"        //% block=&quot;B4&quot;\" line78=\"        B4 = 494,\" line79=\"        //% block=&quot;C5&quot;\" line80=\"        C5 = 523,\" line81=\"        //% block=&quot;C#5&quot;\" line82=\"        Cs5 = 554,\" line83=\"        //% block=&quot;D5&quot;\" line84=\"        D5 = 587,\" line85=\"        //% block=&quot;D#5&quot;\" line86=\"        Ds5 = 622,\" line87=\"        //% block=&quot;E5&quot;\" line88=\"        E5 = 659,\" line89=\"        //% block=&quot;F5&quot;\" line90=\"        F5 = 698,\" line91=\"        //% block=&quot;F#5&quot;\" line92=\"        Fs5 = 740,\" line93=\"        //% block=&quot;G5&quot;\" line94=\"        G5 = 784,\" line95=\"        //% block=&quot;G#5&quot;\" line96=\"        Gs5 = 831,\" line97=\"        //% block=&quot;A5&quot;\" line98=\"        A5 = 880,\" line99=\"        //% block=&quot;A#5&quot;\" line100=\"        As5 = 932,\" line101=\"        //% block=&quot;B5&quot;\" line102=\"        B5 = 988,\" line103=\"        //% block=&quot;C6&quot;\" line104=\"        C6 = 1047,\" line105=\"        //% block=&quot;Rest&quot;\" line106=\"        Rest = 0\" line107=\"    }\" line108=\"\" line109=\"    /**\" line110=\"     * Musical note durations\" line111=\"     * Based on standard music notation\" line112=\"     */\" line113=\"    export enum Duration {\" line114=\"        //% block=&quot;Whole&quot;\" line115=\"        Whole = 4,\" line116=\"        //% block=&quot;Half&quot;\" line117=\"        Half = 2,\" line118=\"        //% block=&quot;Quarter&quot;\" line119=\"        Quarter = 1,\" line120=\"        //% block=&quot;Eighth&quot;\" line121=\"        Eighth = 0.5,\" line122=\"        //% block=&quot;Sixteenth&quot;\" line123=\"        Sixteenth = 0.25,\" line124=\"        //% block=&quot;Dotted Half&quot;\" line125=\"        DottedHalf = 3,\" line126=\"        //% block=&quot;Dotted Quarter&quot;\" line127=\"        DottedQuarter = 1.5,\" line128=\"        //% block=&quot;Dotted Eighth&quot;\" line129=\"        DottedEighth = 0.75\" line130=\"    }\" line131=\"\" line132=\"    /**\" line133=\"     * Dynamic markings (volume levels)\" line134=\"     * From pianissimo (very soft) to fortissimo (very loud)\" line135=\"     */\" line136=\"    export enum Dynamic {\" line137=\"        //% block=&quot;pp&quot;\" line138=\"        PP = 30,\" line139=\"        //% block=&quot;p&quot;\" line140=\"        P = 60,\" line141=\"        //% block=&quot;mp&quot;\" line142=\"        MP = 90,\" line143=\"        //% block=&quot;mf&quot;\" line144=\"        MF = 130,\" line145=\"        //% block=&quot;f&quot;\" line146=\"        F = 180,\" line147=\"        //% block=&quot;ff&quot;\" line148=\"        FF = 255\" line149=\"    }\" line150=\"\" line151=\"    let currentTempo = 120;\" line152=\"    let currentDynamic = Dynamic.MF;\" line153=\"    let radioGroup = 1;\" line154=\"    let isPlayerMode = false;\" line155=\"    let conductorSignalReceived = false;\" line156=\"\" line157=\"    /**\" line158=\"     * Set the tempo in beats per minute\" line159=\"     */\" line160=\"    //% block=&quot;set tempo to $bpm BPM&quot;\" line161=\"    //% bpm.min=40 bpm.max=240 bpm.defl=120\" line162=\"    //% weight=100\" line163=\"    export function setTempo(bpm: number): void {\" line164=\"        currentTempo = bpm;\" line165=\"    }\" line166=\"\" line167=\"    /**\" line168=\"     * Change tempo gradually over several measures\" line169=\"     */\" line170=\"    //% block=&quot;change tempo to $newBpm over $measures measures&quot;\" line171=\"    //% newBpm.min=40 newBpm.max=240\" line172=\"    //% measures.min=1 measures.max=16\" line173=\"    //% weight=98\" line174=\"    export function changeTempo(newBpm: number, measures: number): void {\" line175=\"        let startBpm = currentTempo;\" line176=\"        let steps = measures * 4;\" line177=\"        let increment = (newBpm - startBpm) / steps;\" line178=\"\" line179=\"        for (let i = 0; i &lt; steps; i++) {\" line180=\"            currentTempo = startBpm + (increment * i);\" line181=\"            basic.pause(calculateDuration(Duration.Quarter));\" line182=\"        }\" line183=\"        currentTempo = newBpm;\" line184=\"    }\" line185=\"\" line186=\"    /**\" line187=\"     * Set the dynamic (volume) level\" line188=\"     */\" line189=\"    //% block=&quot;set dynamic to $dynamic&quot;\" line190=\"    //% weight=97\" line191=\"    export function setDynamic(dynamic: Dynamic): void {\" line192=\"        currentDynamic = dynamic;\" line193=\"    }\" line194=\"\" line195=\"    function calculateDuration(duration: Duration): number {\" line196=\"        let quarterNoteDuration = 60000 / currentTempo;\" line197=\"        return quarterNoteDuration * duration;\" line198=\"    }\" line199=\"\" line200=\"    /**\" line201=\"     * Play a single note\" line202=\"     */\" line203=\"    //% block=&quot;play note $note || for $duration at $dynamic&quot;\" line204=\"    //% duration.defl=Duration.Quarter\" line205=\"    //% expandableArgumentMode=&quot;toggle&quot;\" line206=\"    //% weight=90\" line207=\"    export function playNote(note: Note, duration: Duration = Duration.Quarter, dynamic: Dynamic = null): void {\" line208=\"        if (dynamic === null) {\" line209=\"            dynamic = currentDynamic;\" line210=\"        }\" line211=\"\" line212=\"        if (note === Note.Rest) {\" line213=\"            basic.pause(calculateDuration(duration));\" line214=\"        } else {\" line215=\"            music.setVolume(dynamic);\" line216=\"            music.playTone(note, calculateDuration(duration));\" line217=\"        }\" line218=\"    }\" line219=\"\" line220=\"    /**\" line221=\"     * Play a rest (silence)\" line222=\"     */\" line223=\"    //% block=&quot;rest for $duration&quot;\" line224=\"    //% duration.defl=Duration.Quarter\" line225=\"    //% weight=89\" line226=\"    export function rest(duration: Duration): void {\" line227=\"        basic.pause(calculateDuration(duration));\" line228=\"    }\" line229=\"\" line230=\"    /**\" line231=\"     * Stop all sounds\" line232=\"     */\" line233=\"    //% block=&quot;stop all sounds&quot;\" line234=\"    //% weight=80\" line235=\"    export function stopAll(): void {\" line236=\"        music.stopAllSounds();\" line237=\"    }\" line238=\"\" line239=\"    // ========== MULTI-VOICE SUPPORT ==========\" line240=\"\" line241=\"    let voices: Voice[] = [];\" line242=\"    let currentVoiceIndex = 0;\" line243=\"\" line244=\"    class Voice {\" line245=\"        notes: Note[];\" line246=\"        durations: Duration[];\" line247=\"        dynamic: Dynamic;\" line248=\"        startDelay: number;\" line249=\"\" line250=\"        constructor() {\" line251=\"            this.notes = [];\" line252=\"            this.durations = [];\" line253=\"            this.dynamic = Dynamic.MF;\" line254=\"            this.startDelay = 0;\" line255=\"        }\" line256=\"    }\" line257=\"\" line258=\"    /**\" line259=\"     * Create a new voice part (1-4)\" line260=\"     */\" line261=\"    //% block=&quot;create voice $voiceNumber&quot;\" line262=\"    //% voiceNumber.min=1 voiceNumber.max=4\" line263=\"    //% weight=75\" line264=\"    export function createVoice(voiceNumber: number): void {\" line265=\"        while (voices.length &lt; voiceNumber) {\" line266=\"            voices.push(new Voice());\" line267=\"        }\" line268=\"        currentVoiceIndex = voiceNumber - 1;\" line269=\"    }\" line270=\"\" line271=\"    /**\" line272=\"     * Add a note to the current voice\" line273=\"     */\" line274=\"    //% block=&quot;add to voice: $note for $duration&quot;\" line275=\"    //% duration.defl=Duration.Quarter\" line276=\"    //% weight=74\" line277=\"    export function addNoteToVoice(note: Note, duration: Duration): void {\" line278=\"        if (voices.length === 0) {\" line279=\"            createVoice(1);\" line280=\"        }\" line281=\"        voices[currentVoiceIndex].notes.push(note);\" line282=\"        voices[currentVoiceIndex].durations.push(duration);\" line283=\"    }\" line284=\"\" line285=\"    /**\" line286=\"     * Set the dynamic for the current voice\" line287=\"     */\" line288=\"    //% block=&quot;set voice dynamic to $dynamic&quot;\" line289=\"    //% weight=73\" line290=\"    export function setVoiceDynamic(dynamic: Dynamic): void {\" line291=\"        if (voices.length === 0) {\" line292=\"            createVoice(1);\" line293=\"        }\" line294=\"        voices[currentVoiceIndex].dynamic = dynamic;\" line295=\"    }\" line296=\"\" line297=\"    /**\" line298=\"     * Set a delay before this voice starts\" line299=\"     */\" line300=\"    //% block=&quot;set voice delay $measures measures&quot;\" line301=\"    //% measures.min=0 measures.max=16\" line302=\"    //% weight=72\" line303=\"    export function setVoiceDelay(measures: number): void {\" line304=\"        if (voices.length === 0) {\" line305=\"            createVoice(1);\" line306=\"        }\" line307=\"        voices[currentVoiceIndex].startDelay = measures * 4 * (60000 / currentTempo);\" line308=\"    }\" line309=\"\" line310=\"    /**\" line311=\"     * Play all voices\" line312=\"     */\" line313=\"    //% block=&quot;play all voices&quot;\" line314=\"    //% weight=71\" line315=\"    export function playAllVoices(): void {\" line316=\"        let maxLength = 0;\" line317=\"        for (let voice of voices) {\" line318=\"            if (voice.notes.length &gt; maxLength) {\" line319=\"                maxLength = voice.notes.length;\" line320=\"            }\" line321=\"        }\" line322=\"\" line323=\"        for (let j = 0; j &lt; maxLength; j++) {\" line324=\"            for (let voice2 of voices) {\" line325=\"                if (j &lt; voice2.notes.length) {\" line326=\"                    if (j === 0 &amp;&amp; voice2.startDelay &gt; 0) {\" line327=\"                        basic.pause(voice2.startDelay);\" line328=\"                    }\" line329=\"                    let oldDynamic = currentDynamic;\" line330=\"                    currentDynamic = voice2.dynamic;\" line331=\"                    playNote(voice2.notes[j], voice2.durations[j]);\" line332=\"                    currentDynamic = oldDynamic;\" line333=\"                }\" line334=\"            }\" line335=\"        }\" line336=\"    }\" line337=\"\" line338=\"    /**\" line339=\"     * Clear all voices\" line340=\"     */\" line341=\"    //% block=&quot;clear all voices&quot;\" line342=\"    //% weight=69\" line343=\"    export function clearAllVoices(): void {\" line344=\"        voices = [];\" line345=\"        currentVoiceIndex = 0;\" line346=\"    }\" line347=\"\" line348=\"    // ========== RADIO SYNCHRONIZATION ==========\" line349=\"\" line350=\"    /**\" line351=\"     * Setup as conductor (sends start signals)\" line352=\"     */\" line353=\"    //% block=&quot;setup as conductor on group $group&quot;\" line354=\"    //% group.min=1 group.max=255 group.defl=1\" line355=\"    //% weight=65\" line356=\"    export function setupConductor(group: number): void {\" line357=\"        radioGroup = group;\" line358=\"        radio.setGroup(radioGroup);\" line359=\"        isPlayerMode = false;\" line360=\"        basic.showIcon(IconNames.Butterfly);\" line361=\"    }\" line362=\"\" line363=\"    /**\" line364=\"     * Setup as player (receives start signals)\" line365=\"     */\" line366=\"    //% block=&quot;setup as player on group $group&quot;\" line367=\"    //% group.min=1 group.max=255 group.defl=1\" line368=\"    //% weight=64\" line369=\"    export function setupPlayer(group: number): void {\" line370=\"        radioGroup = group;\" line371=\"        radio.setGroup(radioGroup);\" line372=\"        isPlayerMode = true;\" line373=\"        conductorSignalReceived = false;\" line374=\"\" line375=\"        radio.onReceivedString(function (receivedString: string) {\" line376=\"            if (receivedString === &quot;START&quot;) {\" line377=\"                conductorSignalReceived = true;\" line378=\"                basic.showIcon(IconNames.Yes);\" line379=\"                basic.pause(500);\" line380=\"                basic.clearScreen();\" line381=\"            } else if (receivedString === &quot;STOP&quot;) {\" line382=\"                stopAll();\" line383=\"                basic.showIcon(IconNames.No);\" line384=\"            }\" line385=\"        })\" line386=\"\" line387=\"        basic.showIcon(IconNames.SmallHeart);\" line388=\"    }\" line389=\"\" line390=\"    /**\" line391=\"     * Conductor: Send start signal\" line392=\"     */\" line393=\"    //% block=&quot;conductor send START&quot;\" line394=\"    //% weight=63\" line395=\"    export function conductorStart(): void {\" line396=\"        if (!isPlayerMode) {\" line397=\"            radio.sendString(&quot;START&quot;);\" line398=\"            basic.showIcon(IconNames.Yes);\" line399=\"            basic.pause(500);\" line400=\"            basic.clearScreen();\" line401=\"        }\" line402=\"    }\" line403=\"\" line404=\"    /**\" line405=\"     * Conductor: Send stop signal\" line406=\"     */\" line407=\"    //% block=&quot;conductor send STOP&quot;\" line408=\"    //% weight=62\" line409=\"    export function conductorStop(): void {\" line410=\"        if (!isPlayerMode) {\" line411=\"            radio.sendString(&quot;STOP&quot;);\" line412=\"            stopAll();\" line413=\"        }\" line414=\"    }\" line415=\"\" line416=\"    /**\" line417=\"     * Player: Wait for conductor's start signal\" line418=\"     */\" line419=\"    //% block=&quot;player wait for START&quot;\" line420=\"    //% weight=61\" line421=\"    export function playerWaitForStart(): void {\" line422=\"        if (isPlayerMode) {\" line423=\"            basic.showIcon(IconNames.SmallHeart);\" line424=\"            while (!conductorSignalReceived) {\" line425=\"                basic.pause(100);\" line426=\"            }\" line427=\"            conductorSignalReceived = false;\" line428=\"        }\" line429=\"    }\" line430=\"\" line431=\"    // ========== UTILITY BLOCKS ==========\" line432=\"\" line433=\"    /**\" line434=\"     * Wait for a number of measures\" line435=\"     */\" line436=\"    //% block=&quot;wait $measures measures&quot;\" line437=\"    //% measures.min=1 measures.max=32\" line438=\"    //% weight=54\" line439=\"    export function waitMeasures(measures: number): void {\" line440=\"        let quarterNoteDuration2 = 60000 / currentTempo;\" line441=\"        basic.pause(measures * 4 * quarterNoteDuration2);\" line442=\"    }\" line443=\"\" line444=\"    /**\" line445=\"     * Play a metronome for practice\" line446=\"     */\" line447=\"    //% block=&quot;metronome for $measures measures&quot;\" line448=\"    //% measures.min=1 measures.max=32\" line449=\"    //% weight=53\" line450=\"    export function metronome(measures: number): void {\" line451=\"        let totalBeats = measures * 4;\" line452=\"        let beatDuration = 60000 / currentTempo;\" line453=\"\" line454=\"        for (let k = 0; k &lt; totalBeats; k++) {\" line455=\"            if (k % 4 === 0) {\" line456=\"                music.playTone(1000, 100);\" line457=\"            } else {\" line458=\"                music.playTone(800, 50);\" line459=\"            }\" line460=\"            basic.pause(beatDuration - 100);\" line461=\"        }\" line462=\"    }\" line463=\"}\" numlines=\"464\"></mutation></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":0,"diffs":[[1,"/**\n * ═══════════════════════════════════════════════════════════════\n * \n * READY TO USE!\n * \n * ═══════════════════════════════════════════════════════════════\n * \n * The Orchestra blocks are now available in your toolbox!\n * \n * Look for the orange \"Orchestra\" category.\n * \n * Quick Start Example - Try this code:\n * \n * orchestra.setTempo(120)\n * \n * orchestra.playNote(orchestra.Note.C4, orchestra.Duration.Quarter)\n * \n * orchestra.playNote(orchestra.Note.E4, orchestra.Duration.Quarter)\n * \n * orchestra.playNote(orchestra.Note.G4, orchestra.Duration.Quarter)\n * \n * orchestra.playNote(orchestra.Note.C5, orchestra.Duration.Half)\n * \n * Or switch to Blocks view and drag Orchestra blocks!\n * \n * ═══════════════════════════════════════════════════════════════\n */\nnamespace orchestra {\n"]]},{"start1":796,"length1":0,"diffs":[[1,"    /**\n     * All musical notes from C2 (bass) to B6 (high treble)\n     * Full orchestral range\n     */\n    export enum Note {\n        //% block=\"C2\"\n        C2 = 65,\n        //% block=\"C#2\"\n        Cs2 = 69,\n        //% block=\"D2\"\n        D2 = 73,\n        //% block=\"D#2\"\n        Ds2 = 78,\n        //% block=\"E2\"\n        E2 = 82,\n        //% block=\"F2\"\n        F2 = 87,\n        //% block=\"F#2\"\n        Fs2 = 93,\n        //% block=\"G2\"\n        G2 = 98,\n        //% block=\"G#2\"\n        Gs2 = 104,\n        //% block=\"A2\"\n        A2 = 110,\n        //% block=\"A#2\"\n        As2 = 117,\n        //% block=\"B2\"\n        B2 = 123,\n        //% block=\"C3\"\n        C3 = 131,\n        //% block=\"C#3\"\n        Cs3 = 139,\n        //% block=\"D3\"\n        D3 = 147,\n        //% block=\"D#3\"\n        Ds3 = 156,\n        //% block=\"E3\"\n        E3 = 165,\n        //% block=\"F3\"\n        F3 = 175,\n        //% block=\"F#3\"\n        Fs3 = 185,\n        //% block=\"G3\"\n        G3 = 196,\n        //% block=\"G#3\"\n        Gs3 = 208,\n        //% block=\"A3\"\n        A3 = 220,\n        //% block=\"A#3\"\n        As3 = 233,\n        //% block=\"B3\"\n        B3 = 247,\n        //% block=\"C4\"\n        C4 = 262,\n        //% block=\"C#4\"\n        Cs4 = 277,\n        //% block=\"D4\"\n        D4 = 294,\n        //% block=\"D#4\"\n        Ds4 = 311,\n        //% block=\"E4\"\n        E4 = 330,\n        //% block=\"F4\"\n        F4 = 349,\n        //% block=\"F#4\"\n        Fs4 = 370,\n        //% block=\"G4\"\n        G4 = 392,\n        //% block=\"G#4\"\n        Gs4 = 415,\n        //% block=\"A4\"\n        A4 = 440,\n        //% block=\"A#4\"\n        As4 = 466,\n        //% block=\"B4\"\n        B4 = 494,\n        //% block=\"C5\"\n        C5 = 523,\n        //% block=\"C#5\"\n        Cs5 = 554,\n        //% block=\"D5\"\n        D5 = 587,\n        //% block=\"D#5\"\n        Ds5 = 622,\n        //% block=\"E5\"\n        E5 = 659,\n        //% block=\"F5\"\n        F5 = 698,\n        //% block=\"F#5\"\n        Fs5 = 740,\n        //% block=\"G5\"\n        G5 = 784,\n        //% block=\"G#5\"\n        Gs5 = 831,\n        //% block=\"A5\"\n        A5 = 880,\n        //% block=\"A#5\"\n        As5 = 932,\n        //% block=\"B5\"\n        B5 = 988,\n        //% block=\"C6\"\n        C6 = 1047,\n        //% block=\"Rest\"\n        Rest = 0\n    }\n\n    /**\n     * Musical note durations\n     * Based on standard music notation\n     */\n    export enum Duration {\n        //% block=\"Whole\"\n        Whole = 4,\n        //% block=\"Half\"\n        Half = 2,\n        //% block=\"Quarter\"\n        Quarter = 1,\n        //% block=\"Eighth\"\n        Eighth = 0.5,\n        //% block=\"Sixteenth\"\n        Sixteenth = 0.25,\n        //% block=\"Dotted Half\"\n        DottedHalf = 3,\n        //% block=\"Dotted Quarter\"\n        DottedQuarter = 1.5,\n        //% block=\"Dotted Eighth\"\n        DottedEighth = 0.75\n    }\n\n    /**\n     * Dynamic markings (volume levels)\n     * From pianissimo (very soft) to fortissimo (very loud)\n     */\n    export enum Dynamic {\n        //% block=\"pp\"\n        PP = 30,\n        //% block=\"p\"\n        P = 60,\n        //% block=\"mp\"\n        MP = 90,\n        //% block=\"mf\"\n        MF = 130,\n        //% block=\"f\"\n        F = 180,\n        //% block=\"ff\"\n        FF = 255\n    }\n\n    let currentTempo = 120;\n    let currentDynamic = Dynamic.MF;\n    let radioGroup = 1;\n    let isPlayerMode = false;\n    let conductorSignalReceived = false;\n\n    /**\n     * Set the tempo in beats per minute\n     */\n    //% block=\"set tempo to $bpm BPM\"\n    //% bpm.min=40 bpm.max=240 bpm.defl=120\n    //% weight=100\n    export function setTempo(bpm: number): void {\n        currentTempo = bpm;\n    }\n\n    /**\n     * Change tempo gradually over several measures\n     */\n    //% block=\"change tempo to $newBpm over $measures measures\"\n    //% newBpm.min=40 newBpm.max=240\n    //% measures.min=1 measures.max=16\n    //% weight=98\n    export function changeTempo(newBpm: number, measures: number): void {\n        let startBpm = currentTempo;\n        let steps = measures * 4;\n        let increment = (newBpm - startBpm) / steps;\n\n        for (let i = 0; i < steps; i++) {\n            currentTempo = startBpm + (increment * i);\n            basic.pause(calculateDuration(Duration.Quarter));\n        }\n        currentTempo = newBpm;\n    }\n\n    /**\n     * Set the dynamic (volume) level\n     */\n    //% block=\"set dynamic to $dynamic\"\n    //% weight=97\n    export function setDynamic(dynamic: Dynamic): void {\n        currentDynamic = dynamic;\n    }\n\n    function calculateDuration(duration: Duration): number {\n        let quarterNoteDuration = 60000 / currentTempo;\n        return quarterNoteDuration * duration;\n    }\n\n    /**\n     * Play a single note\n     */\n    //% block=\"play note $note || for $duration at $dynamic\"\n    //% duration.defl=Duration.Quarter\n    //% expandableArgumentMode=\"toggle\"\n    //% weight=90\n    export function playNote(note: Note, duration: Duration = Duration.Quarter, dynamic: Dynamic = null): void {\n        if (dynamic === null) {\n            dynamic = currentDynamic;\n        }\n\n        if (note === Note.Rest) {\n            basic.pause(calculateDuration(duration));\n        } else {\n            music.setVolume(dynamic);\n            music.playTone(note, calculateDuration(duration));\n        }\n    }\n\n    /**\n     * Play a rest (silence)\n     */\n    //% block=\"rest for $duration\"\n    //% duration.defl=Duration.Quarter\n    //% weight=89\n    export function rest(duration: Duration): void {\n        basic.pause(calculateDuration(duration));\n    }\n\n    /**\n     * Stop all sounds\n     */\n    //% block=\"stop all sounds\"\n    //% weight=80\n    export function stopAll(): void {\n        music.stopAllSounds();\n    }\n\n    // ========== MULTI-VOICE SUPPORT ==========\n\n    let voices: Voice[] = [];\n    let currentVoiceIndex = 0;\n\n    class Voice {\n        notes: Note[];\n        durations: Duration[];\n        dynamic: Dynamic;\n        startDelay: number;\n\n        constructor() {\n            this.notes = [];\n            this.durations = [];\n            this.dynamic = Dynamic.MF;\n            this.startDelay = 0;\n        }\n    }\n\n    /**\n     * Create a new voice part (1-4)\n     */\n    //% block=\"create voice $voiceNumber\"\n    //% voiceNumber.min=1 voiceNumber.max=4\n    //% weight=75\n    export function createVoice(voiceNumber: number): void {\n        while (voices.length < voiceNumber) {\n            voices.push(new Voice());\n        }\n        currentVoiceIndex = voiceNumber - 1;\n    }\n\n    /**\n     * Add a note to the current voice\n     */\n    //% block=\"add to voice: $note for $duration\"\n    //% duration.defl=Duration.Quarter\n    //% weight=74\n    export function addNoteToVoice(note: Note, duration: Duration): void {\n        if (voices.length === 0) {\n            createVoice(1);\n        }\n        voices[currentVoiceIndex].notes.push(note);\n        voices[currentVoiceIndex].durations.push(duration);\n    }\n\n    /**\n     * Set the dynamic for the current voice\n     */\n    //% block=\"set voice dynamic to $dynamic\"\n    //% weight=73\n    export function setVoiceDynamic(dynamic: Dynamic): void {\n        if (voices.length === 0) {\n            createVoice(1);\n        }\n        voices[currentVoiceIndex].dynamic = dynamic;\n    }\n\n    /**\n     * Set a delay before this voice starts\n     */\n    //% block=\"set voice delay $measures measures\"\n    //% measures.min=0 measures.max=16\n    //% weight=72\n    export function setVoiceDelay(measures: number): void {\n        if (voices.length === 0) {\n            createVoice(1);\n        }\n        voices[currentVoiceIndex].startDelay = measures * 4 * (60000 / currentTempo);\n    }\n\n    /**\n     * Play all voices\n     */\n    //% block=\"play all voices\"\n    //% weight=71\n    export function playAllVoices(): void {\n        let maxLength = 0;\n        for (let voice of voices) {\n            if (voice.notes.length > maxLength) {\n                maxLength = voice.notes.length;\n            }\n        }\n\n        for (let j = 0; j < maxLength; j++) {\n            for (let voice2 of voices) {\n                if (j < voice2.notes.length) {\n                    if (j === 0 && voice2.startDelay > 0) {\n                        basic.pause(voice2.startDelay);\n                    }\n                    let oldDynamic = currentDynamic;\n                    currentDynamic = voice2.dynamic;\n                    playNote(voice2.notes[j], voice2.durations[j]);\n                    currentDynamic = oldDynamic;\n                }\n            }\n        }\n    }\n\n    /**\n     * Clear all voices\n     */\n    //% block=\"clear all voices\"\n    //% weight=69\n    export function clearAllVoices(): void {\n        voices = [];\n        currentVoiceIndex = 0;\n    }\n\n    // ========== RADIO SYNCHRONIZATION ==========\n\n    /**\n     * Setup as conductor (sends start signals)\n     */\n    //% block=\"setup as conductor on group $group\"\n    //% group.min=1 group.max=255 group.defl=1\n    //% weight=65\n    export function setupConductor(group: number): void {\n        radioGroup = group;\n        radio.setGroup(radioGroup);\n        isPlayerMode = false;\n        basic.showIcon(IconNames.Butterfly);\n    }\n\n    /**\n     * Setup as player (receives start signals)\n     */\n    //% block=\"setup as player on group $group\"\n    //% group.min=1 group.max=255 group.defl=1\n    //% weight=64\n    export function setupPlayer(group: number): void {\n        radioGroup = group;\n        radio.setGroup(radioGroup);\n        isPlayerMode = true;\n        conductorSignalReceived = false;\n\n        radio.onReceivedString(function (receivedString: string) {\n            if (receivedString === \"START\") {\n                conductorSignalReceived = true;\n                basic.showIcon(IconNames.Yes);\n                basic.pause(500);\n                basic.clearScreen();\n            } else if (receivedString === \"STOP\") {\n                stopAll();\n                basic.showIcon(IconNames.No);\n            }\n        })\n\n        basic.showIcon(IconNames.SmallHeart);\n    }\n\n    /**\n     * Conductor: Send start signal\n     */\n    //% block=\"conductor send START\"\n    //% weight=63\n    export function conductorStart(): void {\n        if (!isPlayerMode) {\n            radio.sendString(\"START\");\n            basic.showIcon(IconNames.Yes);\n            basic.pause(500);\n            basic.clearScreen();\n        }\n    }\n\n    /**\n     * Conductor: Send stop signal\n     */\n    //% block=\"conductor send STOP\"\n    //% weight=62\n    export function conductorStop(): void {\n        if (!isPlayerMode) {\n            radio.sendString(\"STOP\");\n            stopAll();\n        }\n    }\n\n    /**\n     * Player: Wait for conductor's start signal\n     */\n    //% block=\"player wait for START\"\n    //% weight=61\n    export function playerWaitForStart(): void {\n        if (isPlayerMode) {\n            basic.showIcon(IconNames.SmallHeart);\n            while (!conductorSignalReceived) {\n                basic.pause(100);\n            }\n            conductorSignalReceived = false;\n        }\n    }\n\n    // ========== UTILITY BLOCKS ==========\n\n    /**\n     * Wait for a number of measures\n     */\n    //% block=\"wait $measures measures\"\n    //% measures.min=1 measures.max=32\n    //% weight=54\n    export function waitMeasures(measures: number): void {\n        let quarterNoteDuration2 = 60000 / currentTempo;\n        basic.pause(measures * 4 * quarterNoteDuration2);\n    }\n\n    /**\n     * Play a metronome for practice\n     */\n    //% block=\"metronome for $measures measures\"\n    //% measures.min=1 measures.max=32\n    //% weight=53\n    export function metronome(measures: number): void {\n        let totalBeats = measures * 4;\n        let beatDuration = 60000 / currentTempo;\n\n        for (let k = 0; k < totalBeats; k++) {\n            if (k % 4 === 0) {\n                music.playTone(1000, 100);\n            } else {\n                music.playTone(800, 50);\n            }\n            basic.pause(beatDuration - 100);\n        }\n    }\n}\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":2,"length1":34,"diffs":[[1,"    \"name\": \"Music Test\",\n"]]},{"start1":233,"length1":44,"diffs":[[1,""]]}]},{"type":"added","filename":"test.ts","value":"// tests go here; this will not be compiled when this package is used as an extension.\n"}]}],"snapshots":[{"timestamp":1771899664728,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"Music Test\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1771900711323}